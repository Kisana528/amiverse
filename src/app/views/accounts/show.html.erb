<% content_for :main_content do %>
  <% provide(:title, 'アカウント詳細') %>
  <% if @account.present? %>
    <div class="account-container" id="account-container">
      <div class="top-container">
        <div class="banner-container" id="banner-container" >
          <% if !@account.banner_id.blank? %>
            <%= image_tag generate_ati_url(@account.account_id, 'banner', @account.banner_id), class: 'account-banner' %>
          <% else %>
            <%= image_tag 'banner.webp', class: 'account-banner' %>
          <% end %>
        </div>
      </div>
      <div class="name-container fixed" id="name-container">
        <div id="name-before"></div>
        <div class="icon-container">
          <% if !@account.icon_id.blank? %>
            <%= image_tag generate_ati_url(@account.account_id, 'icon', @account.icon_id), class: 'account-icon' %>
          <% else %>
            <%= image_tag 'icon.webp', class: 'account-icon' %>
          <% end %>
        </div>
        <div class="meta-container">
          <h1><%= @account.name %></h1>
          <div>@<%= @account.name_id %></div>
          <% if @account == @current_account %>
            <%= link_to('設定', settings_path) %>
          <% else %>
            <% if Follow.exists?(follow_to_id: @account.account_id, follow_from_id: @current_account.account_id) %>
              <%= button_to("フォロー解除", follow_path(@account.name_id), method: :post) %>
            <% else %>
              <%= button_to("フォローする", follow_path(@account.name_id), method: :post) %>
            <% end %>
          <% end %>
        </div>
      </div>

      <div class="profile-container">
        <div><span>紹介:</span><%= @account.bio %></div>
        <div><span>場所:</span><%= @account.location %></div>
        <div><span>誕生日:</span><%= @account.birthday&.strftime("%Y年 %m月 %d日") %></div>
        <div><span>フォロワー:</span><%= @account.followers.count %></div>
        <div><span>フォロー中:</span><%= @account.following.count %></div>
        <div><span>投稿数:</span><%= @account.items_count %></div>
        <div><span>参加日:</span><%= @account.created_at.strftime("%Y年 %m月 %d日") %></div>
      </div>
      <div class="account-tab-container">
        <div>投稿</div>
        <div>返信</div>
        <div>メディア</div>
        <div>リアクション</div>
      </div>
      <div class="content-container">
        <div id="items">
          <% @account.items.where(reply_item_id: '').each do |item| %>
            <% if item.reply_to_items.empty? %>
              <%= render 'items/item', item: item, show_reply_from: true %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  <% else %>
    <p>@<%= params[:name_id] %>というアカウントが見つかりませんでした。。。</p>
  <% end %>
<% end %>
<%= render 'layouts/no_header' %>